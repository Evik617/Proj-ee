{% extends "base.html" %}{% block title %}Запись на консультацию{% endblock %}{% block content %}    <h1>Запись на консультацию</h1>    <form method="POST">        {{ form.hidden_tag() }}        <p>            {{ form.date.label }}<br>            {{ form.date() }}            {% if form.date.errors %}                <ul class="errors">                    {% for error in form.date.errors %}                        <li>{{ error }}</li>                    {% endfor %}                </ul>            {% endif %}        </p>        <p>            <label for="available_times">Доступное время:</label><br>            <select id="available_times" name="time">                <option value="">Выберите время</option>            </select>        </p>        <p>            {{ form.fio.label }}<br>            {{ form.fio() }}            {% if form.fio.errors %}                <ul class="errors">                    {% for error in form.fio.errors %}                        <li>{{ error }}</li>                    {% endfor %}                </ul>            {% endif %}        </p>        <p>{{ form.submit() }}</p>    </form>    {% with messages = get_flashed_messages(with_categories=true) %}      {% if messages %}        <ul>        {% for category, message in messages %}          <li class="{{ category }}">{{ message }}</li>        {% endfor %}        </ul>      {% endif %}    {% endwith %}    <script>        document.addEventListener('DOMContentLoaded', function() {            const dateSelect = document.getElementById('date');            const timeSelect = document.getElementById('available_times');            dateSelect.addEventListener('change', function() {                const dateId = dateSelect.value;                // Очищаем поле выбора времени                timeSelect.innerHTML = '<option value="">Выберите время</option>';                if (dateId) {                    fetch(`/get_available_times?date_id=${dateId}`)                        .then(response => response.json())                        .then(times => {                            times.forEach(time => {                                const option = document.createElement('option');                                option.value = time;                                option.textContent = time;                                timeSelect.appendChild(option);                            });                        });                }            });        });    </script>{% endblock %}
{# templates/booking.html #}{% extends "base.html" %}{% block title %}Запись на консультацию{% endblock %}{% block content %}    <h1>Запись на консультацию</h1>    {% with messages = get_flashed_messages(with_categories=true) %}      {% if messages %}        <div class="flashes">          {% for category, message in messages %}            <div class="alert alert-{{ category }}">{{ message }}</div>          {% endfor %}        </div>      {% endif %}    {% endwith %}    <form method="POST" action="{{ url_for('routes.book') }}">        <p>            <label for="date">Дата:</label><br>            <select id="date" name="date">                {% for date in dates %}                    <option value="{{ date.id }}">{{ date.date }}</option>                {% endfor %}            </select>        </p>        <p>            <label for="subject">Предмет:</label><br>            <select id="subject" name="subject">                {% for subject in subjects %}                    <option value="{{ subject.id }}">{{ subject.name }}</option>                {% endfor %}            </select>        </p>        <p>            <label for="teacher">Учитель:</label><br>            <select id="teacher" name="teacher">                {% for teacher in teachers %}                    <option value="{{ teacher.id }}">{{ teacher.username }}</option>                {% endfor %}            </select>        </p>        <p>            <label for="time">Время:</label><br>            <select id="time" name="time">                <option value="">Выберите время</option>            </select>        </p>        <p>            <label for="fio">ФИО родителя:</label><br>            <input type="text" id="fio" name="fio">        </p>        <p><button type="submit">Записаться</button></p>    </form>    <script>        document.addEventListener('DOMContentLoaded', function () {            const dateSelect = document.getElementById('date');            const subjectSelect = document.getElementById('subject');            const teacherSelect = document.getElementById('teacher');            const timeSelect = document.getElementById('time');            function updateAvailableTimes() {                const dateId = dateSelect.value;                const subjectId = subjectSelect.value;                const teacherId = teacherSelect.value;                timeSelect.innerHTML = '<option value="">Выберите время</option>';                if (dateId && subjectId && teacherId) {                    fetch(`/get_available_times?date_id=${dateId}&subject_id=${subjectId}&teacher_id=${teacherId}`)                        .then(response => response.json())                        .then(times => {                            times.forEach(time => {                                const option = document.createElement('option');                                option.value = time;                                option.textContent = time;                                timeSelect.appendChild(option);                            });                        });                }            }            dateSelect.addEventListener('change', updateAvailableTimes);            subjectSelect.addEventListener('change', updateAvailableTimes);            teacherSelect.addEventListener('change', updateAvailableTimes);        });    </script>{% endblock %}